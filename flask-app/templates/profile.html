{% extends "base.html" %}

{% block title %}Profile - Pursuit{% endblock %}

{% block content %}

<script>
    document.addEventListener('DOMContentLoaded', function()) {
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const currentUserIndex = sessionStorage.getItem('currentUserIndex');
        let user= null;
        if (currentUserIndex !== null && users[currentUserIndex]) {
            user = users[currentUserIndex];
        } 
        if (user) {
            document.getElementById('profileName').textContent = user.username + "'s Profile";
            document.getElementById('displayName').textContent = user.username || '';
            document.getElementById('displayEmail').textContent = user.email || '';
            document.getElementById('displayHobbies').textContent = user.hobby || '';
        } else {
            document.getElementById('profileInfo').innerHTML = "<p>Please <a href='/login'>log in</a> to view your profile.</p>"; 
            document.getElementById('profileName').textContent = "User's Profile";
        }  
    }
</script>

<div class="container mt-4">
  <h2>Welcome, {{ user.username }}</h2>
  <p><strong>Email:</strong> {{ user.email }}</p>
  <h4>Hobbies:</h4>
  <ul>
    {% if user.hobbies %}
      {% for hobby in user.hobbies %}
        <li>{{ hobby.hobby }}</li>
      {% endfor %}
    {% else %}
      <li>No hobbies listed.</li>
    {% endif %}
  </ul>
  <a href="{{ url_for('edit_profile') }}" class="btn btn-secondary mt-3">Edit Profile</a>
  <a href="{{ url_for('logout') }}" class="btn btn-danger mt-3 ms-2">Logout</a>
</div>
{% endblock %}