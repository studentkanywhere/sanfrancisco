{% extends "base.html" %}

{% block title %}Profile - Pursuit{% endblock %}

{% block content %}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const currentUserIndex = sessionStorage.getItem('currentUserIndex');
        let user= null;
        if (currentUserIndex !== null && users[currentUserIndex]) {
            user = users[currentUserIndex];
        } 
        if (user) {
            document.getElementById('profileName').textContent = user.username + "'s Profile";
            document.getElementById('displayName').textContent = user.username || '';
            document.getElementById('displayEmail').textContent = user.email || '';
            document.getElementById('displayHobbies').textContent = user.hobby || '';
        } else {
            document.getElementById('profileInfo').innerHTML = "<p>Please <a href='/login'>log in</a> to view your profile.</p>"; 
            document.getElementById('profileName').textContent = "User's Profile";
        }  
</script>

<div class="container mt-4">
    <h2 id="profileName">User's Profile</h2>
    <div id="profileInfo">
        <p><strong>Name:</strong> <span id="displayName"></span></p>
        <p><strong>Email:</strong> <span id="displayEmail"></span></p>
        <p><strong>Hobbies:</strong> <span id="displayHobbies"></span></p>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get the last signed-up or logged-in user (for demo, using the last user in localStorage)
    const users = JSON.parse(localStorage.getItem('users')) || [];
    // You may want to store the "current user" in localStorage/sessionStorage on login for a real app
    const user = users[users.length - 1];

    if (user) {
        document.getElementById('profileName').textContent = user.username + "'s Profile";
        document.getElementById('displayName').textContent = user.username || '';
        document.getElementById('displayEmail').textContent = user.email || '';
        document.getElementById('displayHobbies').textContent = user.hobby || '';
    } else {
        document.getElementById('profileInfo').innerHTML = "<p>No user info found. Please sign up or log in.</p>";
    }
});
</script>

{% endblock %}}